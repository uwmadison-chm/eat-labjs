{
  "components": {
    "1": {
      "id": "1",
      "type": "lab.canvas.Screen",
      "content": [
        {
          "type": "i-text",
          "version": "2.7.0",
          "originX": "center",
          "originY": "center",
          "left": 0,
          "top": -250,
          "width": 320.32,
          "height": 36.16,
          "fill": "#ffffff",
          "stroke": "#dddddd",
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "round",
          "strokeMiterLimit": 4,
          "scaleX": 1,
          "scaleY": 1,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Instructions go here",
          "fontSize": 32,
          "fontWeight": "normal",
          "fontFamily": "sans-serif",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "center",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "id": "3",
          "styles": {}
        },
        {
          "type": "i-text",
          "version": "2.7.0",
          "originX": "center",
          "originY": "center",
          "left": 12,
          "top": 225,
          "width": 496.38,
          "height": 36.16,
          "fill": "#ffffff",
          "stroke": "#dddddd",
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "round",
          "strokeMiterLimit": 4,
          "scaleX": 1,
          "scaleY": 1,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Press a key or click to continue",
          "fontSize": 32,
          "fontWeight": "normal",
          "fontFamily": "sans-serif",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "center",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "id": "25",
          "styles": {}
        }
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "",
            "keypress",
            "",
            ""
          ],
          [
            "",
            "click",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "Comments",
              "message": "run",
              "code": "/*\nEmpathic Accuracy Task\n\nTODO: Kral citation for this\n\nSome notes about this task...\n*/"
            }
          ]
        ]
      },
      "viewport": [
        800,
        600
      ],
      "title": "Instructions",
      "_tab": "Scripts"
    },
    "3": {
      "id": "3",
      "type": "lab.html.Screen",
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "Video player",
              "message": "run",
              "code": "// TODO: real video location\nvar video_location = \"https://brainimaging.waisman.wisc.edu/~dfitch/eat/\";\n\nvar comp = this;\nvar body = document.getElementsByTagName('body')[0];\nvar container = document.getElementsByClassName(\"container\")[0];\nvar title = document.getElementById(\"title\");\nvar left_text = document.getElementById(\"left_text\");\nvar right_text = document.getElementById(\"right_text\");\nvar player_container = document.getElementById(\"player_container\");\nvar player = document.getElementById(\"player\");\n\nvar rating = document.getElementById(\"rating\");\nvar marker = document.getElementById(\"marker\");\n\nvar canplay = false;\nvar canrate = false;\nvar start_time;\nvar data = [];\n\nvar container_width;\nvar width;\nvar margin; \nvar marker_width;\nvar marker_max;\n\n\nif (this.parameters.cue == 'gaze') {\n    title.innerHTML = \"Where is this person looking?\";\n    left_text.innerHTML = \"Left\";\n    right_text.innerHTML = \"Right\";\n} else if (this.parameters.cue == 'self') {\n    title.innerHTML = \"How are you feeling?\";\n    left_text.innerHTML = \"Very Negative\";\n    right_text.innerHTML = \"Very Positive\";\n} else {\n    title.innerHTML = \"How did this person feel?\";\n    left_text.innerHTML = \"Very Negative\";\n    right_text.innerHTML = \"Very Positive\";\n}\n\n// Pull a video off by pseudo-random\nvar video_filename;\nvar video_bin;\nif (this.parameters.affect == \"positive\") {\n  video_bin = this.state.positive_videos;\n} else {\n  video_bin = this.state.negative_videos;\n}\n\nvideo_index = Math.trunc(this.state.rng() * video_bin.length);\nvideo_filename = video_bin[video_index];\nvideo_bin.splice(video_index, 1);\n\nplayer.src = video_location + video_filename;\n\nfunction userResize(){\n  container_width = container.offsetWidth;\n  width = window.innerWidth;\n  margin = (width - container_width) / 2.0; \n  marker_width = marker.clientWidth;\n  marker_max = width - margin - marker_width - 6;\n}\n\nwindow.performance = window.performance || {};\nperformance.now = (function() {\n    return performance.now    ||\n        performance.mozNow    ||\n        performance.msNow     ||\n        performance.oNow      ||\n        performance.webkitNow ||            \n        Date.now  /*none found - fallback to browser default */\n})();\n\nfunction hideCursor(){\n  body.className = 'nocursor';\n}\n\nfunction showCursor(){\n  body.className = '';\n}\n\nfunction startVideo(){\n  if (canplay) {\n    canplay = false;\n    canrate = true;\n\n    player_container.style.display = \"block\";\n    player.style.display = \"block\";\n    rating.style.display = \"block\";\n    userResize();\n    hideCursor();\n   \n    start_time = performance.now();\n    player.play();\n  }\n}\n\nfunction mouseMove(e){\n  if (!canrate) {\n    return;\n  }\n\n  current_x = e.pageX - margin;\n\n  // constrain to box\n  if (current_x < margin) {\n    current_x = margin\n  } else if (current_x > marker_max) {\n    current_x = marker_max\n  }\n\n  marker.style.marginLeft = (current_x - margin) + \"px\";\n\n  // normalize x by window width when storing\n  var stored_x = current_x / width\n  data.push({\n    value: current_x,\n    playerTime: player.currentTime,\n    browserTime: performance.now() - start_time,\n  });\n}\n\ndocument.addEventListener('mousemove', mouseMove, false);\ndocument.addEventListener('resize', userResize, false);\n\nplayer.addEventListener(\"canplay\", function() {\n  canplay = true;\n  startVideo();\n});\n\nplayer.addEventListener(\"ended\", function() {\n  // Shove data into the response and go to next component\n  comp.respond(data);\n});\n\n/*\nplayer.addEventListener(\"click\", function() {\n  startVideo();\n});\n*/\n"
            }
          ]
        ]
      },
      "title": "Video - Continuous",
      "content": "\n<div id=\"player_container\">\n  <h1 id=\"title\">How is this person feeling?</h1>\n  <video id=\"player\" preload width=\"100%\" type=\"video/mp4\">\n  </video>\n</div>\n\n<div id=\"rating\">\n  <div id=\"left_text\">Left</div>\n  <div id=\"right_text\">Right</div>\n  <div id=\"bar\">\n  <span id=\"marker\">\n    &nbsp;\n  </span>\n  </div>\n</div>",
      "_tab": "Scripts",
      "timeout": ""
    },
    "7": {
      "id": "7",
      "type": "lab.flow.Loop",
      "children": [
        "10"
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "templateParameters": {
        "columns": [
          {
            "name": "number",
            "type": "string"
          },
          {
            "name": "",
            "type": "string"
          }
        ],
        "rows": [
          [
            "1",
            ""
          ],
          [
            "2",
            ""
          ]
        ]
      },
      "sample": {
        "mode": "sequential"
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "prepare",
              "message": "run",
              "code": "function getParameterByName(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, '\\\\$&');\n    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\n\nthis.state.ppt = getParameterByName('PPT') || 0;\nthis.state.session = getParameterByName('session') || 0;\n\n// Make a predictable pseudorandom number generator based on ppt and session id\nthis.state.rng = new Math.seedrandom(String(this.state.ppt) + '/' + String(this.state.session));\n\n\n// Init the possible video lists, so we can pull without replacement\n\nthis.state.positive_videos = [\n  \"positive_ex1.mp4\",\n  \"positive_ex2.mp4\",\n  \"positive_ex3.mp4\",\n  \"positive_ex4.mp4\",\n  \"positive_ex5.mp4\",\n  \"positive_ex6.mp4\",\n];\n\nthis.state.negative_videos = [\n  \"negative_ex1.mp4\",\n  \"negative_ex2.mp4\",\n  \"negative_ex3.mp4\",\n  \"negative_ex4.mp4\",\n  \"negative_ex5.mp4\",\n  \"negative_ex6.mp4\",\n  \"negative_ex7.mp4\",\n  \"negative_ex8.mp4\",\n  \"negative_ex9.mp4\",\n];\n\n"
            }
          ]
        ]
      },
      "title": "Experiment",
      "_tab": "Scripts"
    },
    "8": {
      "id": "8",
      "type": "lab.flow.Loop",
      "children": [
        "12"
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "templateParameters": {
        "columns": [
          {
            "name": "cue",
            "type": "string"
          },
          {
            "name": "affect",
            "type": "string"
          }
        ],
        "rows": [
          [
            "self",
            "positive"
          ],
          [
            "self",
            "negative"
          ],
          [
            "other",
            "positive"
          ],
          [
            "other",
            "negative"
          ],
          [
            "gaze",
            "positive"
          ],
          [
            "gaze",
            "negative"
          ]
        ]
      },
      "sample": {
        "mode": "sequential",
        "n": "6"
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "",
              "message": "",
              "code": ""
            }
          ]
        ]
      },
      "title": "Trials",
      "_tab": "Scripts"
    },
    "10": {
      "id": "10",
      "type": "lab.flow.Sequence",
      "children": [
        "8",
        "11"
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "",
              "message": "",
              "code": ""
            }
          ]
        ]
      },
      "title": "Block (trials then break)",
      "_tab": "Content"
    },
    "11": {
      "id": "11",
      "type": "lab.html.Screen",
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "click",
            "click",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "",
              "message": "",
              "code": ""
            }
          ]
        ]
      },
      "title": "Break",
      "content": "<h1 id=\"title\">Time to take a break.</h1>\n\n<p>Click when ready to continue.</p>",
      "_tab": "Behavior",
      "skip": false,
      "skipCondition": "${this.parameters.number == 2}"
    },
    "12": {
      "id": "12",
      "type": "lab.flow.Sequence",
      "children": [
        "14",
        "13",
        "3"
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "",
              "message": "",
              "code": ""
            }
          ]
        ]
      },
      "title": "Trial sequence"
    },
    "13": {
      "id": "13",
      "type": "lab.canvas.Screen",
      "content": [
        {
          "type": "i-text",
          "version": "2.7.0",
          "originX": "center",
          "originY": "center",
          "left": 0,
          "top": 0,
          "width": 40.68,
          "height": 81.36,
          "fill": "#ffffff",
          "stroke": "#000000",
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "round",
          "strokeMiterLimit": 4,
          "scaleX": 1,
          "scaleY": 1,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "+",
          "fontSize": "72",
          "fontWeight": "normal",
          "fontFamily": "Times New Roman",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "center",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "id": "88",
          "styles": {}
        }
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "",
              "message": "",
              "code": ""
            }
          ]
        ]
      },
      "viewport": [
        800,
        600
      ],
      "title": "Fixation cross",
      "_tab": "Behavior",
      "timeout": "2000"
    },
    "14": {
      "id": "14",
      "type": "lab.canvas.Screen",
      "content": [
        {
          "type": "i-text",
          "version": "2.7.0",
          "originX": "center",
          "originY": "center",
          "left": 0,
          "top": 0,
          "width": 625.44,
          "height": 36.16,
          "fill": "#ffffff",
          "stroke": "",
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "round",
          "strokeMiterLimit": 4,
          "scaleX": 1,
          "scaleY": 1,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "${this.parameters.cue.toUpperCase()}",
          "fontSize": 32,
          "fontWeight": "normal",
          "fontFamily": "sans-serif",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "center",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "id": "89",
          "styles": {}
        }
      ],
      "files": {
        "rows": []
      },
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "responses": {
        "rows": [
          [
            "",
            "",
            "",
            ""
          ]
        ]
      },
      "messageHandlers": {
        "rows": [
          [
            {
              "title": "",
              "message": "",
              "code": ""
            }
          ]
        ]
      },
      "viewport": [
        800,
        600
      ],
      "title": "Cue word",
      "_tab": "Content",
      "timeout": "5000"
    },
    "root": {
      "id": "root",
      "title": "root",
      "type": "lab.flow.Sequence",
      "children": [
        "1",
        "7"
      ],
      "parameters": {
        "rows": [
          [
            {
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        ]
      },
      "plugins": [
        {
          "type": "lab.plugins.Metadata"
        }
      ],
      "metadata": {
        "title": "EAT - Empathic Accuracy Task",
        "description": "",
        "repository": "",
        "contributors": "Dan Fitch <dfitch@wisc.edu>"
      }
    }
  },
  "version": [
    19,
    1,
    0
  ],
  "files": {
    "files": {
      "index.html": {
        "content": "data:text/html,%3C!doctype%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%3Ctitle%3EExperiment%3C%2Ftitle%3E%0A%20%20%3C!--%20viewport%20setup%20--%3E%0A%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%20initial-scale%3D1%22%3E%0A%20%20%3C!--%20lab.js%20library%20and%20experiment%20code%20--%3E%0A%20%20%24%7B%20header%20%7D%0A%3C%2Fhead%3E%0A%3Cbody%3E%0A%20%20%3C!--%20If%20you'd%20rather%20have%20a%20container%20with%20a%20fixed%20width%0A%20%20%20%20%20%20%20and%20variable%20height%2C%20try%20removing%20the%20fullscreen%20class%20below%20--%3E%0A%20%20%3Cdiv%20class%3D%22container%20fullscreen%22%20data-labjs-section%3D%22main%22%3E%0A%20%20%20%20%3Cmain%20class%3D%22content-vertical-center%20content-horizontal-center%22%3E%0A%20%20%20%20%20%20%3Cdiv%3E%0A%20%20%20%20%20%20%20%20%3Ch2%3ELoading%20Experiment%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%3Cp%3EThe%20experiment%20is%20loading%20and%20should%20start%20in%20a%20few%20seconds%3C%2Fp%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fmain%3E%0A%20%20%3C%2Fdiv%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A",
        "source": "library"
      },
      "style.css": {
        "content": "data:text/css,body%20%7B%0A%20%20color%3A%20white%3B%0A%20%20background-color%3A%20black%3B%0A%7D%0A%0A.container%20%7B%20border%3A%20none%3B%20%7D%0A%0A.nocursor%20%7B%20cursor%3A%20none%3B%20%7D%0A%0Avideo%3A%3A-webkit-media-controls-fullscreen-button%2Cvideo%3A%3A-webkit-media-controls-play-button%2C%20video%3A%3A-webkit-media-controls-pausebutton%20%7B%0A%20%20%20%20display%3A%20none%3B%0A%7D%0A%0A%23title%20%7B%0A%20%20text-align%3A%20center%3B%0A%7D%0A%0A%23player_container%20%7B%0A%20%20display%3A%20none%3B%0A%20%20margin%3A%200%20auto%3B%0A%20%20max-width%3A%201000px%3B%0A%7D%0A%0A%23player%20%7B%0A%20%20width%3A%20100%25%3B%0A%7D%0A%0A%23rating%20%7B%0A%20%20display%3A%20none%3B%0A%20%20margin-top%3A%202em%3B%0A%7D%0A%0A%23bar%20%7B%0A%20%20display%3A%20block%3B%0A%20%20width%3A%20100%25%3B%0A%20%20background-color%3A%20%23666%3B%0A%20%20border%3A%200.1em%20solid%20%23eee%3B%0A%20%20border-radius%3A%200.6em%3B%0A%7D%0A%0A%23left_text%2C%20%23right_text%20%7B%0A%20%20font-size%3A%20200%25%3B%0A%20%20position%3A%20relative%3B%0A%20%20top%3A%203em%3B%0A%7D%0A%23left_text%20%7B%20%0A%20%20float%3A%20left%3B%0A%7D%0A%23right_text%20%7B%0A%20%20float%3A%20right%3B%0A%7D%0A%0A%23marker%20%7B%0A%20%20display%3A%20block%3B%0A%20%20width%3A%205em%3B%0A%20%20height%3A%205em%3B%0A%20%20background-color%3A%20%2344a%3B%0A%20%20border%3A%200.1em%20solid%20%23226%3B%0A%20%20border-radius%3A%200.5em%3B%0A%7D",
        "source": "library"
      }
    },
    "bundledFiles": {
      "lib/lab.js": {
        "type": "application/javascript"
      },
      "lib/lab.js.map": {
        "type": "text/plain"
      },
      "lib/lab.fallback.js": {
        "type": "application/javascript"
      },
      "lib/lab.legacy.js": {
        "type": "application/javascript"
      },
      "lib/lab.legacy.js.map": {
        "type": "text/plain"
      },
      "lib/lab.css": {
        "type": "text/css"
      },
      "lib/loading.svg": {
        "type": "image/svg+xml"
      }
    }
  }
}